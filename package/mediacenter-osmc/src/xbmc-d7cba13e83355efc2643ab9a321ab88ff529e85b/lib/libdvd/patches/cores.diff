diff -uwr ../../dvdnav_diff/config.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/config.h
--- ../../dvdnav_diff/config.h	Sun Sep 14 22:02:38 2008
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/config.h	Sat Oct 19 06:29:41 2013
@@ -1,56 +1,95 @@
-/* config.h.  Generated by hand.  */
+#pragma once
 
-#ifndef LIBDVDREAD_CONFIG_H
-#define LIBDVDREAD_CONFIG_H
+/*
+ *      Copyright (C) 2005-2013 Team XBMC
+ *      http://xbmc.org
+ *
+ *  This Program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2, or (at your option)
+ *  any later version.
+ *
+ *  This Program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with XBMC; see the file COPYING.  If not, see
+ *  <http://www.gnu.org/licenses/>.
+ *
+ */
 
-#define HAVE_DLFCN_H 1
+/* config.h.  Generated by hand.  */
+#if defined(TARGET_POSIX)
+#include "PlatformInclude.h"
+#else
+#include <windows.h>
+#endif
+#include <stdio.h>
+
+//#define HAVE_DLFCN_H 1
+#define HAVE_DVDCSS_DVDCSS_H 1
 /* #undef HAVE_DVDCSS_DVDCSS_H*/
 /* #undef HAVE_INTTYPES_H */
 #define HAVE_MEMORY_H 1
-/* #undef HAVE_STDINT_H */
+#define HAVE_STDINT_H 1
 #define HAVE_STDLIB_H 1
 #define HAVE_STRINGS_H 1
 #define HAVE_STRING_H 1
 #define HAVE_SYS_STAT_H 1
 #define HAVE_SYS_TYPES_H 1
 /* #undef HAVE_UNISTD_H */
+#ifndef PACKAGE
 #define PACKAGE "libdvdread"
+#endif
+#ifndef PACKAGE_BUGREPORT
 #define PACKAGE_BUGREPORT ""
+#endif
+#ifndef PACKAGE_NAME
 #define PACKAGE_NAME ""
+#endif
+#ifndef PACKAGE_STRING
 #define PACKAGE_STRING ""
+#endif
+#ifndef PACKAGE_TARNAME
 #define PACKAGE_TARNAME ""
+#endif
+#ifndef PACKAGE_VERSION
 #define PACKAGE_VERSION ""
+#endif
 #define STDC_HEADERS 1
+#ifndef VERSION
 #define VERSION "1.2.6"
+#endif
 /* #undef WORDS_BIGENDIAN */
 /* #undef __DARWIN__ */
 /* #undef const */
 #define inline __inline
 /* #undef size_t */
 
-#define ssize_t __int64
+#define ssize_t int
 
 #ifndef PATH_MAX
 #define PATH_MAX MAX_PATH
 #endif
 
+#ifndef strcasecmp
 #define strcasecmp stricmp
+#endif
+#ifndef strncasecmp
 #define strncasecmp strnicmp
+#endif
 
+#ifndef S_ISDIR
 #define S_ISDIR(m) ((m) & _S_IFDIR)
+#endif
+#ifndef S_ISREG
 #define S_ISREG(m) ((m) & _S_IFREG)
+#endif
+#ifndef S_ISBLK
 #define S_ISBLK(m) 0
+#endif
+#ifndef S_ISCHR
 #define S_ISCHR(m) 0
-
-/* Fallback types (very x86-centric, sorry) */
-typedef unsigned char       uint8_t;
-typedef signed char         int8_t;
-typedef unsigned short      uint16_t;
-typedef signed short        int16_t;
-typedef unsigned int        uint32_t;
-typedef signed int          int32_t;
-typedef unsigned __int64    uint64_t;
-typedef signed __int64      int64_t;
-typedef unsigned int        uintptr_t;
-
-#endif /* LIBDVDREAD_CONFIG_H */
+#endif
diff -uwr ../../dvdnav_diff/decoder.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/decoder.h
--- ../../dvdnav_diff/decoder.h	Sun Sep 14 21:31:44 2008
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/decoder.h	Fri Feb  7 19:51:38 2014
@@ -22,6 +22,9 @@
 #ifndef LIBDVDNAV_DECODER_H
 #define LIBDVDNAV_DECODER_H
 
+#include "ifo_types.h" /*  vm_cmd_t */
+#include "dvdnav_internal.h"
+
 /* link command types */
 typedef enum {
   LinkNoLink  = 0,
diff -uwr ../../dvdnav_diff/dvd_reader.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvd_reader.h
--- ../../dvdnav_diff/dvd_reader.h	Mon Dec  7 03:50:20 2009
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvd_reader.h	Thu Feb  7 18:22:32 2013
@@ -24,14 +24,14 @@
 #define LIBDVDREAD_DVD_READER_H
 
 #ifdef _MSC_VER
-#include <config.h>
+#include "config.h"
 
 #include <stdio.h>
 #include <stdlib.h>
 #endif
 
 #include <sys/types.h>
-#include <inttypes.h>
+//#include <inttypes.h>
 
 /**
  * The DVD access interface.
diff -uwr ../../dvdnav_diff/dvd_types.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvd_types.h
--- ../../dvdnav_diff/dvd_types.h	Tue Dec 30 14:48:46 2008
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvd_types.h	Fri Feb  7 20:03:34 2014
@@ -60,7 +60,8 @@
 
 /* the following types are currently unused */
 
-#if 0
+//XBMC Needs some of these
+#if 1
 
 /* Domain */
 typedef enum {
@@ -161,14 +162,13 @@
 /* The audio format */
 typedef enum {
   DVD_AUDIO_FORMAT_AC3       = 0,
-  DVD_AUDIO_FORMAT_MPEG1     = 1,
-  DVD_AUDIO_FORMAT_MPEG1_DRC = 2,
-  DVD_AUDIO_FORMAT_MPEG2     = 3,
-  DVD_AUDIO_FORMAT_MPEG2_DRC = 4,
-  DVD_AUDIO_FORMAT_LPCM      = 5,
+  DVD_AUDIO_FORMAT_UNKNOWN_1  = 1,
+  DVD_AUDIO_FORMAT_MPEG       = 2,
+  DVD_AUDIO_FORMAT_MPEG2_EXT  = 3,
+  DVD_AUDIO_FORMAT_LPCM       = 4,
+  DVD_AUDIO_FORMAT_UNKNOWN_5  = 5,
   DVD_AUDIO_FORMAT_DTS       = 6,
-  DVD_AUDIO_FORMAT_SDDS      = 7,
-  DVD_AUDIO_FORMAT_Other     = 8
+  DVD_AUDIO_FORMAT_SDDS       = 7
 } DVDAudioFormat_t;
 
 /* Audio language extension */
@@ -222,6 +222,10 @@
   DVD_DISPLAY_MODE_4x3Letterboxed = 3
 } DVDDisplayMode_t;
 
+typedef int DVDAudioSampleFreq_t;
+typedef int DVDAudioSampleQuant_t;
+typedef int DVDChannelNumber_t;
+
 /* Audio attributes */
 typedef struct {
   DVDAudioAppMode_t     AppMode;
@@ -233,9 +237,6 @@
   DVDAudioSampleQuant_t SampleQuantization;
   DVDChannelNumber_t    NumberOfChannels;
 } DVDAudioAttributes_t;
-typedef int DVDAudioSampleFreq_t;
-typedef int DVDAudioSampleQuant_t;
-typedef int DVDChannelNumber_t;
 
 /* Subpicture attributes */
 typedef enum {
@@ -255,6 +256,8 @@
   DVDSubpictureLangExt_t LanguageExtension;
 } DVDSubpictureAttributes_t;
 
+typedef int DVDVideoCompression_t;
+
 /* Video attributes */
 typedef struct {
   DVDBool_t PanscanPermitted;
@@ -268,7 +271,6 @@
   DVDBool_t Line21Field2InGop;
   int more_to_come;
 } DVDVideoAttributes_t;
-typedef int DVDVideoCompression_t;
 
 #endif
 
diff -uwr ../../dvdnav_diff/dvdnav.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav.h
--- ../../dvdnav_diff/dvdnav.h	Sun Oct  6 21:47:20 2013
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav.h	Fri Feb  7 19:58:51 2014
@@ -32,11 +32,11 @@
 extern "C" {
 #endif
 
-#include <dvdnav/dvd_types.h>
-#include <dvdread/dvd_reader.h>
-#include <dvdread/nav_types.h>
-#include <dvdread/ifo_types.h> /* For vm_cmd_t */
-#include <dvdnav/dvdnav_events.h>
+#  include "dvd_types.h"
+#  include "dvd_reader.h"
+#  include "nav_types.h"
+#  include "ifo_types.h" /* For vm_cmd_t */
+#  include "dvdnav_events.h"
 
 
 
@@ -695,6 +695,10 @@
  */
 int8_t dvdnav_is_domain_vts(dvdnav_t *self);
 
+/* XBMC added functions */
+int dvdnav_get_button_info(dvdnav_t* self, int alpha[2][4], int color[2][4]);
+
+int64_t dvdnav_convert_time(dvd_time_t *time);
 
 #ifdef __cplusplus
 }
diff -uwr ../../dvdnav_diff/dvdnav_events.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav_events.h
--- ../../dvdnav_diff/dvdnav_events.h	Tue Dec 30 14:48:46 2008
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav_events.h	Sat Feb  9 11:12:51 2013
@@ -25,6 +25,10 @@
 #ifndef LIBDVDNAV_DVDNAV_EVENTS_H
 #define LIBDVDNAV_DVDNAV_EVENTS_H
 
+#include "ifo_types.h"
+#include "dvd_reader.h"
+#include "nav_types.h"
+
 /*
  * DVDNAV_BLOCK_OK
  *
diff -uwr ../../dvdnav_diff/dvdnav_internal.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav_internal.h
--- ../../dvdnav_diff/dvdnav_internal.h	Sun Dec  9 21:22:16 2012
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/dvdnav_internal.h	Fri Feb  7 20:06:27 2014
@@ -25,9 +25,15 @@
 #include "config.h"
 #endif
 
-#ifdef WIN32
+#include <stdlib.h>
+#include <stdio.h>
+#include <limits.h>
+#include <string.h>
+
+#ifdef TARGET_WINDOWS
 
 /* pthread_mutex_* wrapper for win32 */
+#ifndef TARGET_POSIX
 #include <windows.h>
 #include <process.h>
 typedef CRITICAL_SECTION pthread_mutex_t;
@@ -35,6 +41,7 @@
 #define pthread_mutex_lock(a)    EnterCriticalSection(a)
 #define pthread_mutex_unlock(a)  LeaveCriticalSection(a)
 #define pthread_mutex_destroy(a) DeleteCriticalSection(a)
+#endif // !TARGET_POSIX
 
 #ifndef HAVE_GETTIMEOFDAY
 /* replacement gettimeofday implementation */
@@ -50,14 +57,24 @@
 #define gettimeofday(TV, TZ) _private_gettimeofday((TV), (TZ))
 #endif
 
+#ifndef TARGET_POSIX
 #include <io.h> /* read() */
 #define lseek64 _lseeki64
+#endif // !TARGET_POSIX
 
 #else
 
 #include <pthread.h>
 
-#endif /* WIN32 */
+#endif /* TARGET_WINDOWS */
+
+/* Uncomment for VM command tracing */
+/* #define TRACE */
+
+#include "decoder.h"
+#include "dvdnav.h"
+#include "vm.h"
+#include "vmcmd.h"
 
 /* where should libdvdnav write its messages (stdout/stderr) */
 #define MSG_OUT stderr
@@ -183,6 +200,18 @@
 /* converts a dvd_time_t to PTS ticks */
 int64_t dvdnav_convert_time(dvd_time_t *time);
 
+/* XBMC added functions */
+/*
+ * Get current playback state
+ */
+dvdnav_status_t dvdnav_get_state(dvdnav_t *self, dvd_state_t *save_state);
+
+/*
+ * Resume playback state
+ */
+dvdnav_status_t dvdnav_set_state(dvdnav_t *self, dvd_state_t *save_state);
+/* end XBMC */
+
 /** USEFUL MACROS **/
 
 #ifdef __GNUC__
@@ -195,7 +224,7 @@
 #else
 #define printerrf(...) \
 	do { if (this) snprintf(this->err_str, MAX_ERR_LEN, __VA_ARGS__); } while (0)
-#endif /* WIN32 */
+#endif /* TARGET_WINDOWS */
 #endif
 #define printerr(str) \
 	do { if (this) strncpy(this->err_str, str, MAX_ERR_LEN - 1); } while (0)
diff -uwr ../../dvdnav_diff/ifo_types.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/ifo_types.h
--- ../../dvdnav_diff/ifo_types.h	Sun Dec  9 21:08:00 2012
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/ifo_types.h	Fri Feb  7 19:24:37 2014
@@ -22,8 +22,8 @@
 #ifndef LIBDVDREAD_IFO_TYPES_H
 #define LIBDVDREAD_IFO_TYPES_H
 
-#include <inttypes.h>
-#include "dvdread/dvd_reader.h"
+//#include <inttypes.h>
+#include "dvd_reader.h"
 
 
 #undef ATTRIBUTE_PACKED
diff -uwr ../../dvdnav_diff/nav_types.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/nav_types.h
--- ../../dvdnav_diff/nav_types.h	Sun Aug  8 23:49:28 2010
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/nav_types.h	Thu Feb  7 18:22:32 2013
@@ -28,9 +28,27 @@
 #ifndef LIBDVDREAD_NAV_TYPES_H
 #define LIBDVDREAD_NAV_TYPES_H
 
-#include <inttypes.h>
+//#include <inttypes.h>
 #include "ifo_types.h" /* only dvd_time_t, vm_cmd_t and user_ops_t */
 
+
+#undef ATTRIBUTE_PACKED
+#undef PRAGMA_PACK_BEGIN 
+#undef PRAGMA_PACK_END
+
+#if defined(__GNUC__)
+#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 95)
+#define ATTRIBUTE_PACKED __attribute__ ((packed))
+#define PRAGMA_PACK 0
+#endif
+#endif
+
+#if !defined(ATTRIBUTE_PACKED)
+#define ATTRIBUTE_PACKED
+#define PRAGMA_PACK 1
+#endif
+
+
 /* The length including the substream id byte. */
 #define PCI_BYTES 0x3d4
 #define DSI_BYTES 0x3fa
@@ -41,6 +59,12 @@
 /* Remove this */
 #define DSI_START_BYTE 1031
 
+
+#if PRAGMA_PACK
+#pragma pack(1)
+#endif
+
+
 /**
  * PCI General Information
  */
Only in xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/: remap.h
diff -uwr ../../dvdnav_diff/vm.h xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/vm.h
--- ../../dvdnav_diff/vm.h	Sat Jul 31 00:34:16 2010
+++ xbmc/cores/dvdplayer/DVDInputStreams/dvdnav/vm.h	Fri Feb  7 19:37:55 2014
@@ -23,6 +23,9 @@
 #ifndef LIBDVDNAV_VM_H
 #define LIBDVDNAV_VM_H
 
+#include "remap.h"
+#include "dvdnav_internal.h"
+
 /* DOMAIN enum */
 
 typedef enum {
@@ -170,6 +173,9 @@
 ifo_handle_t *vm_get_title_ifo(vm_t *vm, uint32_t title);
 void vm_ifo_close(ifo_handle_t *ifo);
 
+int vm_get_state(vm_t *vm, dvd_state_t *save_state);
+int vm_set_state(vm_t *vm, dvd_state_t *save_state);
+
 /* Uncomment for VM command tracing */
 /* #define TRACE */
 #ifdef TRACE
@@ -177,5 +183,7 @@
 void vm_position_print(vm_t *vm, vm_position_t *position);
 #endif
 
+/* XBMC added functions */
+vm_t* dvdnav_get_vm(dvdnav_t *self);
 
 #endif /* LIBDVDNAV_VM_H */
